PDF Search — wyszukiwarka treści w plikach PDF
================================================

Aplikacja webowa uruchamiana w Dockerze. Indeksuje pliki PDF (tekstowe i skany)
z wybranego katalogu na dysku i umożliwia wyszukiwanie fraz przez przeglądarkę.
Skany są rozpoznawane automatycznie przez OCR (Tesseract, język polski).


1. WYMAGANIA

   Docker i Docker Compose.


2. INSTALACJA I URUCHOMIENIE

   Konfiguracja — plik .env obok docker-compose.yml:

       PDF_DIR=/ścieżka/do/katalogu/z/pdfami
       PORT=8080

   Uruchomienie:

       docker compose up -d --build

   Aplikacja dostępna pod adresem http://localhost:8080 (lub inny ustawiony PORT).

   Zatrzymanie:

       docker compose down


3. JAK PRZEBIEGA INDEKSOWANIE

   Indeksowanie uruchamia się automatycznie przy starcie kontenera.

   Dla każdej strony PDF-a:
   a) Najpierw próbuje wyciągnąć tekst programowo (pdfplumber).
   b) Jeśli strona zawiera mniej niż 50 znaków (np. skan), automatycznie
      uruchamia OCR (Tesseract, język polski) — decyzja zapada osobno
      dla każdej strony, więc mieszane PDF-y są obsługiwane poprawnie.

   Pliki rozpoznawane są po sumie SHA-256 — jeśli plik się nie zmienił,
   jest pomijany przy ponownym indeksowaniu.

   Zindeksowane dane trafiają do bazy SQLite z FTS5 (pełnotekstowe
   wyszukiwanie). Baza zapisywana jest w katalogu z PDF-ami jako plik
   .pdf_search_index.db

   Indeksowanie działa w tle po stronie serwera. Przeglądarka NIE musi
   być otwarta — wystarczy że kontener Docker jest uruchomiony.
   Postęp można śledzić w interfejsie webowym lub odpytując endpoint
   GET /indexing-status

   Ponowne indeksowanie można wywołać:
   - przyciskiem "Reindeksuj" w interfejsie webowym
   - żądaniem: curl -X POST http://localhost:8080/reindex


4. DODAWANIE NOWYCH DOKUMENTÓW

   Skopiuj pliki PDF do katalogu wskazanego przez PDF_DIR (domyślnie: ./data).
   Pliki mogą być w podkatalogach.

   Następnie uruchom reindeksację:
   a) kliknij przycisk "Reindeksuj" w interfejsie webowym, lub
   b) wyślij żądanie: curl -X POST http://localhost:8080/reindex

   Zaindeksowane zostaną tylko nowe i zmienione pliki — istniejące
   zostaną pominięte.


5. ZMIANA KATALOGU PDF BEZ RESTARTU KONTENERA

   Zmiana podkatalogu wewnątrz zamontowanego wolumenu działa z poziomu UI
   (dropdown "Katalog" nad wyszukiwarką) — bez restartu.

   Zmiana ścieżki hosta (inny PDF_DIR) wymaga restartu kontenera,
   bo Docker mount jest ustawiany przy tworzeniu kontenera.

   Obejście 1: zamontuj szerszy katalog

     Zamontuj katalog nadrzędny, np. cały home:

         PDF_DIR=/home/jan docker compose up --build

     Wtedy w UI zobaczysz podkatalogi (dokumenty, projekty/raporty, itd.)
     i przełączasz się między nimi bez restartu.

   Obejście 2: symlinki

     Zamontuj jeden katalog i wrzucaj do niego symlinki do innych lokalizacji:

         mkdir -p ./data
         ln -s /home/jan/dokumenty ./data/dokumenty
         ln -s /home/jan/raporty ./data/raporty

     Wtedy wszystkie katalogi są widoczne pod /data w kontenerze.
